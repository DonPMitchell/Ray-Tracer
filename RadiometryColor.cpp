#include "stdafx.h"
#include "RadiometryColor.h"
#include "MonteCarlo.h"
#include "Affine.h"
#pragma intrinsic (fabs, sqrt)

#define D_PI            3.14159265358979323846264338327950288419716939937510
#define C_BOLTZMANN     1.3806503e-23   // Joules per Kelvin
#define C_PLANCK        6.62606876e-34  // Joule Seconds  
#define C_SPEEDOFLIGHT  2.99792458e+8   // Meters per Second

DisplayRGB
SpectrumToRGB_Original[NSPEC] = {
    DisplayRGB( 0.001157, -0.000985,  0.006887),   // 380 nm
    DisplayRGB( 0.107452, -0.095917,  0.689206),   // 420 nm
    DisplayRGB( 0.017947, -0.099937,  1.768660),   // 460 nm
    DisplayRGB(-0.616218,  0.612505,  0.221938),   // 500 nm
    DisplayRGB(-0.535522,  1.509083, -0.157020),   // 540 nm
    DisplayRGB( 1.631095,  0.744060, -0.124772),   // 580 nm
    DisplayRGB( 2.183061, -0.113421, -0.029988),   // 620 nm
    DisplayRGB( 0.440585, -0.045395, -0.003270),   // 660 nm
    DisplayRGB( 0.030503, -0.003315, -0.000205),   // 700 nm
    DisplayRGB( 0.001853, -0.000201, -0.000012),   // 740 nm
};

DisplayRGB SpectrumToRGB[NSPEC] = {                 // KaiserSinc interpolating
    DisplayRGB(-0.017172, 0.010345, -0.114207),
    DisplayRGB(0.120923, -0.110828, 0.882190),
    DisplayRGB(0.047209, -0.123077, 1.719954),
    DisplayRGB(-0.676449, 0.679058, 0.214733),
    DisplayRGB(-0.569635, 1.512745, -0.155854),
    DisplayRGB(1.681036, 0.733216, -0.120890),
    DisplayRGB(2.158425, -0.110583, -0.035838),
    DisplayRGB(0.439867, -0.044310, -0.004228),
    DisplayRGB(0.030062, -0.004617, -0.000056),
    DisplayRGB(0.006955, -0.004333, 0.000394),
};
//
//  CIE primaries
//
Spectrum g_sX = {
    0.00136800f,    // 380
    0.13438000f,    // 420
    0.29080001f,    // 460
    0.00490000f,    // 500
    0.29040000f,    // 540
    0.91630000f,    // 580
    0.85444993f,    // 620
    0.16490000f,    // 660
    0.01135916f,    // 700
    0.00069008f,    // 740
};
Spectrum g_sY = {
    0.00003900f,    // 380
    0.00400000f,    // 420
    0.06000000f,    // 460
    0.32300001f,    // 500
    0.95400000f,    // 540
    0.87000000f,    // 580
    0.38100001f,    // 620
    0.06100000f,    // 660
    0.00410200f,    // 700
    0.00024920f,    // 740
};
Spectrum g_sZ = {
    0.00645000f,    // 380
    0.64560002f,    // 420
    1.66919994f,    // 460
    0.27200001f,    // 500
    0.02030000f,    // 540
    0.00165000f,    // 580
    0.00019000f,    // 620
    0.00000000f,    // 660
    0.00000000f,    // 700
    0.00000000f,    // 740
};
//
//  Spectra from ML projects
//
Spectrum g_sVenera14Sky = {
    0.00000000f,    // 380
    0.00000000f,    // 420
    6.38575411f,    // 460
    13.62724876f,    // 500
    28.45650673f,    // 540
    47.49392319f,    // 580
    68.57146454f,    // 620
    67.27050018f,    // 660
    48.91901016f,    // 700
    49.78496170f,    // 740
};
Spectrum g_sVenera14Ground = {
    0.00000000f,    // 380
    0.00000000f,    // 420
    0.00000000f,    // 460
    0.00000000f,    // 500
    1.02879810f,    // 540
    2.00991607f,    // 580
    3.35975718f,    // 620
    4.18325233f,    // 660
    3.31962252f,    // 700
    3.46150589f,    // 740
};
Spectrum g_sVenera13Sky = {
    0.50000000f,    // 380          // extrapolated
    1.00000000f,    // 420          //   "
    2.50000000f,    // 460          //   "
    4.81040621f,    // 500
    9.70742607f,    // 540
    18.40194321f,    // 580
    27.93317032f,    // 620
    31.28616714f,    // 660
    24.68034172f,    // 700
    24.52434540f,    // 740
};
Spectrum g_sVenera13Sky2 = {        // directly from Cosmic Research graph, extrapolated (automated is probably better)
    0.50f,          // 380
    1.00f,          // 420
    2.50f,          // 460
    5.50f,          // 500
   11.00f,          // 540
   20.00f,          // 580
   28.00f,          // 620
   31.00f,          // 660
   25.00f,          // 700
   24.00f,          // 740
};
Spectrum g_sVenera11Sky = {
    0.00000000f,    // 380
    0.00000000f,    // 420
    13.00544453f,    // 460
    29.70198250f,    // 500
    62.57493591f,    // 540
    77.04637909f,    // 580
    86.42578125f,    // 620
    79.01465607f,    // 660
    53.40529251f,    // 700
    67.10257721f,    // 740
};
Spectrum g_sVenera11_07200m = {
    0.00000000f,    // 380
    15.59523582f,    // 420
    52.64508057f,    // 460
    138.02229309f,    // 500
    197.94132996f,    // 540
    208.13537598f,    // 580
    199.71536255f,    // 620
    177.19010925f,    // 660
    128.91119385f,    // 700
    135.82131958f,    // 740
};
Spectrum g_sVenera11_16200m = {
    0.00000000f,    // 380
    93.10010529f,    // 420
    163.39257813f,    // 460
    275.70651245f,    // 500
    338.43029785f,    // 540
    329.92822266f,    // 580
    302.93426514f,    // 620
    262.26467896f,    // 660
    198.91813660f,    // 700
    193.96678162f,    // 740
};
Spectrum g_sVenera11_23700m = {
    0.00000000f,    // 380
    196.46223450f,    // 420
    280.73928833f,    // 460
    387.27697754f,    // 500
    429.63235474f,    // 540
    397.84814453f,    // 580
    361.41796875f,    // 620
    307.69689941f,    // 660
    240.99664307f,    // 700
    223.98660278f,    // 740
};
Spectrum g_sVenera11_37700m = {
    0.00000000f,    // 380
    379.48950195f,    // 420
    479.32437134f,    // 460
    555.19287109f,    // 500
    544.29888916f,    // 540
    471.33551025f,    // 580
    422.26242065f,    // 620
    355.36309814f,    // 660
    291.76629639f,    // 700
    252.43081665f,    // 740
};
Spectrum g_sVenera11_48600m = {
    0.00000000f,    // 380
    411.85897827f,    // 420
    531.44335938f,    // 460
    614.11236572f,    // 500
    585.25592041f,    // 540
    506.66934204f,    // 580
    443.53518677f,    // 620
    380.44635010f,    // 660
    309.07904053f,    // 700
    266.88717651f,    // 740
};
Spectrum g_sVenera11_51100m = {
    0.00000000f,    // 380
    554.06341553f,    // 420
    646.38659668f,    // 460
    718.51434326f,    // 500
    683.90802002f,    // 540
    602.93914795f,    // 580
    539.96832275f,    // 620
    477.23657227f,    // 660
    417.84292603f,    // 700
    379.06246948f,    // 740
};
Spectrum g_sVenera11_56100m = {
    0.00000000f,    // 380
    596.34686279f,    // 420
    718.68408203f,    // 460
    804.45526123f,    // 500
    763.18603516f,    // 540
    670.66986084f,    // 580
    608.25286865f,    // 620
    558.77355957f,    // 660
    509.47348022f,    // 700
    474.54849243f,    // 740
};
Spectrum g_sVenera11_62100m = {
    0.00000000f,    // 380
    965.73968506f,    // 420
    1030.12109375f,    // 460
    1053.53247070f,    // 500
    1014.05505371f,    // 540
    952.47625732f,    // 580
    894.52844238f,    // 620
    840.36346436f,    // 660
    790.71936035f,    // 700
    729.58807373f,    // 740
};
Spectrum g_sVenera11_Sun = {
    0.00000000f,    // 380
    1043.42260742f,    // 420
    1193.90808105f,    // 460
    1153.79125977f,    // 500
    1105.10327148f,    // 540
    1065.05053711f,    // 580
    1012.63867188f,    // 620
    933.63684082f,    // 660
    852.89611816f,    // 700
    780.13519287f,    // 740
};

Spectrum g_sIllumD65 = {
    50.38267899f,    // 380
    92.91006470f,    // 420
    117.58680725f,    // 460
    109.22839355f,    // 500
    104.58039856f,    // 540
    95.39461517f,    // 580
    87.54811859f,    // 620
    80.32710266f,    // 660
    71.66021729f,    // 700
    74.08525848f,    // 740
};
Spectrum g_sSolar = {
    1214.80004883f,    // 380
    1750.40002441f,    // 420
    2069.80004883f,    // 460
    1935.50000000f,    // 500
    1885.59997559f,    // 540
    1863.59997559f,    // 580
    1707.80004883f,    // 620
    1578.40002441f,    // 660
    1470.80004883f,    // 700
    1303.00000000f,    // 740
};
Spectrum g_sEarthSky = {
    0.43551135f,    // 380
    0.77114737f,    // 420
    0.88305128f,    // 460
    0.81567466f,    // 500
    0.72104108f,    // 540
    0.62893146f,    // 580
    0.53809142f,    // 620
    0.45220453f,    // 660
    0.37084064f,    // 700
    0.31576443f,    // 740
};
Spectrum g_sMarsAlbedo = {
    0.04733601f,    // 380
    0.06158728f,    // 420
    0.08237920f,    // 460
    0.10745126f,    // 500
    0.14129725f,    // 540
    0.20419851f,    // 580
    0.24527045f,    // 620
    0.26959482f,    // 660
    0.28531164f,    // 700
    0.29500300f,    // 740
};
Spectrum g_sVenusAlbedo = {
    0.11067757f,    // 380
    0.16131863f,    // 420
    0.18817221f,    // 460
    0.19725907f,    // 500
    0.19778793f,    // 540
    0.19229506f,    // 580
    0.18746668f,    // 620
    0.18181798f,    // 660
    0.18083672f,    // 700
    0.17758393f,    // 740
};
Spectrum g_sVenusUVcontrast = {
    0.17076126f,    // 380
    0.04841660f,    // 420
    0.01764063f,    // 460
    0.00000000f,    // 500
    0.00000000f,    // 540
    0.00000000f,    // 580
    0.00000000f,    // 620
    0.00000000f,    // 660
    0.00000000f,    // 700
    0.00000000f,    // 740
};
Spectrum g_sMercuryAlbedo = {
    0.61959320f,    // 380
    0.71806914f,    // 420
    0.85569346f,    // 460
    0.90238976f,    // 500
    0.97943437f,    // 540
    1.04796708f,    // 580
    1.13404667f,    // 620
    1.24931836f,    // 660
    1.23782849f,    // 700
    1.17489743f,    // 740
};
//
//  Glass filters and test pattern paint colors from Venera missions
//
Spectrum g_sRedChannel = {
    0.00000000f,    // 380
    0.00000000f,    // 420
    0.00000000f,    // 460
    0.00000000f,    // 500
    0.00000000f,    // 540
    0.02941176f,    // 580
    0.98602939f,    // 620
    0.45524511f,    // 660
    0.12107843f,    // 700
    0.00000000f,    // 740
};
Spectrum g_sGrnChannel = {
    0.00000000f,    // 380
    0.00000000f,    // 420
    0.00000000f,    // 460
    0.14803922f,    // 500
    0.97279412f,    // 540
    0.36631879f,    // 580
    0.00000000f,    // 620
    0.00000000f,    // 660
    0.00000000f,    // 700
    0.00000000f,    // 740
};
Spectrum g_sBluChannel = {
    0.00000000f,    // 380
    0.71544945f,    // 420
    0.88110703f,    // 460
    0.10343137f,    // 500
    0.00000000f,    // 540
    0.00000000f,    // 580
    0.00000000f,    // 620
    0.00000000f,    // 660
    0.00000000f,    // 700
    0.00000000f,    // 740
};
Spectrum g_sClrChannel = {
    0.18469463f,    // 380
    0.34878588f,    // 420
    0.65967625f,    // 460
    0.90397352f,    // 500
    0.97682118f,    // 540
    0.96578366f,    // 580
    0.89514351f,    // 620
    0.76821190f,    // 660
    0.55150849f,    // 700
    0.29470199f,    // 740
};

Spectrum g_sCoolGray = {
    0.04586957f,    // 380
    0.19885869f,    // 420
    0.21264753f,    // 460
    0.21597826f,    // 500
    0.20646739f,    // 540
    0.19885869f,    // 580
    0.20157610f,    // 620
    0.23635870f,    // 660
    0.26733696f,    // 700
    0.28527173f,    // 740
};
Spectrum g_sCoolRed = {
    0.02086957f,    // 380
    0.01625000f,    // 420
    0.01298913f,    // 460
    0.01054348f,    // 500
    0.01407609f,    // 540
    0.12385870f,    // 580
    0.37657610f,    // 620
    0.46135870f,    // 660
    0.50375003f,    // 700
    0.51679349f,    // 740
};
Spectrum g_sCoolGrn = {
    0.03581522f,    // 380
    0.09695652f,    // 420
    0.04233696f,    // 460
    0.08690218f,    // 500
    0.20103261f,    // 540
    0.07983696f,    // 580
    0.07902174f,    // 620
    0.13201088f,    // 660
    0.21516305f,    // 700
    0.25211957f,    // 740
};
Spectrum g_sCoolBlu = {
    0.11244565f,    // 380
    0.12711957f,    // 420
    0.12956522f,    // 460
    0.12711957f,    // 500
    0.05565218f,    // 540
    0.03553411f,    // 580
    0.03826087f,    // 620
    0.10173666f,    // 660
    0.15076087f,    // 700
    0.14097823f,    // 740
};

Spectrum g_sHotGray = {
    0.00000000f,    // 380
    0.11440075f,    // 420
    0.18942629f,    // 460
    0.19848315f,    // 500
    0.19117978f,    // 540
    0.18359551f,    // 580
    0.18415731f,    // 620
    0.19433144f,    // 660
    0.21028091f,    // 700
    0.23106742f,    // 740
};
Spectrum g_sHotRed = {
    0.00129214f,    // 380
    0.00325843f,    // 420
    0.00438202f,    // 460
    0.00438202f,    // 500
    0.00213483f,    // 540
    0.01028090f,    // 580
    0.06786517f,    // 620
    0.23734084f,    // 660
    0.37020600f,    // 700
    0.38359553f,    // 740
};
Spectrum g_sHotGrn = {
    0.00915730f,    // 380
    0.01533708f,    // 420
    0.01646068f,    // 460
    0.02170412f,    // 500
    0.06786517f,    // 540
    0.07544944f,    // 580
    0.04595506f,    // 620
    0.05260300f,    // 660
    0.07573034f,    // 700
    0.10297753f,    // 740
};
Spectrum g_sHotBlu = {
    0.00110487f,    // 380
    0.05775281f,    // 420
    0.08808989f,    // 460
    0.07601124f,    // 500
    0.05073034f,    // 540
    0.03359551f,    // 580
    0.03022472f,    // 620
    0.04483146f,    // 660
    0.09386754f,    // 700
    0.12947567f,    // 740
};

//
//  Other spectra from physical data, etc.
//
Spectrum g_sWaterOld = {
    0.00022f,           // 380 nm    absorption in 1/cm
    0.000153f,          // 420 nm
    0.000156f,          // 460 nm
    0.000257f,          // 500 nm
    0.000558f,          // 540 nm
    0.00108f,           // 580 nm
    0.00309f,           // 620 nm
    0.004f,             // 660 nm
    0.0065f,            // 700 nm
    0.0238f,            // 740 nm  
};

Spectrum g_sWater = {
    0.001049f,          // 380 nm    absorption in 1/cm
    0.00042247f,        // 420 nm
    0.00026936f,        // 460 nm
    0.00025133f,        // 500 nm
    0.00039654f,        // 540 nm
    0.0010963f,         // 580 nm
    0.0026957f,         // 620 nm
    0.0035719f,         // 660 nm
    0.0060139f,         // 700 nm
    0.022110f,          // 740 nm  
};

Spectrum g_sHeavyWater = {
    0.00685f,           // 380 nm
    0.00685f,           // 420 nm
    0.00685f,           // 460 nm  extrapolated
    0.00685f,           // 500 nm
    0.00683f,           // 540 nm
    0.00637f,           // 580 nm
    0.00590f,           // 620 nm
    0.00606f,           // 660 nm
    0.00647f,           // 700 nm
    0.00601f,           // 740 nm
};

Spectrum g_sRuby = {
    11.5f,              // 380 nm    absorption in 1/cm
    10.2f,              // 420 nm
     4.0f,              // 460 nm
     2.5f,              // 500 nm
     4.2f,              // 540 nm
     3.0f,              // 580 nm
     0.9f,              // 620 nm
     0.5f,              // 660 nm
     0.3f,              // 700 nm
     0.1f,              // 740 nm  
};

Spectrum g_sEmerald = {
     2.2f,              // 380 nm    absorption in 1/cm
     2.7f,              // 420 nm
     2.5f,              // 460 nm
     1.7f,              // 500 nm
     1.8f,              // 540 nm
     2.5f,              // 580 nm
     2.5f,              // 620 nm
     1.9f,              // 660 nm
     1.9f,              // 700 nm
     2.5f,              // 740 nm  
};

Spectrum g_sSapphire = {
     0.33f,              // 380 nm    absorption in 1/cm
     0.16f,              // 420 nm
     0.21f,              // 460 nm
     0.25f,              // 500 nm
     0.40f,              // 540 nm
     0.45f,              // 580 nm
     0.41f,              // 620 nm
     0.38f,              // 660 nm
     0.35f,              // 700 nm
     0.30f,              // 740 nm  
};

Spectrum g_sWhiskey = {
    4.00f,              // 380 nm    absorption in 1/cm
    1.00f,              // 420 nm
    0.50f,              // 460 nm
    0.30f,              // 500 nm
    0.15f,              // 540 nm
    0.10f,              // 580 nm
    0.05f,              // 620 nm
    0.001f,             // 660 nm
    0.001f,             // 700 nm
    0.001f,             // 740 nm  
};

Spectrum g_sCobaltGlass = {
    26.00f,             // 380 nm    absorption in 1/cm
    28.00f,             // 420 nm
    27.00f,             // 460 nm
    20.50f,             // 500 nm
    13.00f,             // 540 nm
    10.00f,             // 580 nm
    10.00f,             // 620 nm
    12.00f,             // 660 nm
    29.00f,             // 700 nm
    38.00f,             // 740 nm  
};

Spectrum g_sCopper = {
    0.30f,              // 380 nm
    0.35f,              // 420 nm
    0.42f,              // 460 nm
    0.46f,              // 500 nm
    0.48f,              // 540 nm
    0.70f,              // 580 nm
    0.72f,              // 620 nm
    0.82f,              // 660 nm
    0.87f,              // 700 nm
    0.95f,              // 740 nm
};

Spectrum g_sGold = {
    0.38f,              // 380 nm
    0.38f,              // 420 nm
    0.37f,              // 460 nm
    0.50f,              // 500 nm
    0.82f,              // 540 nm
    0.92f,              // 580 nm
    0.95f,              // 620 nm
    0.97f,              // 660 nm
    0.98f,              // 700 nm
    0.98f,              // 740 nm
};

Spectrum g_sCopperExtinction = {
    2.0373f,            // 380 nm
    2.2452f,            // 420 nm
    2.4352f,            // 460 nm
    2.5712f,            // 500 nm
    2.5866f,            // 540 nm
    2.6969f,            // 580 nm
    3.2456f,            // 620 nm
    3.7521f,            // 660 nm
    4.1592f,            // 700 nm
    4.5221f,            // 740 nm
};
Spectrum g_sCopperRefraction = {
    1.3333f,            // 380 nm
    1.2683f,            // 420 nm
    1.2444f,            // 460 nm
    1.2134f,            // 500 nm
    1.0697f,            // 540 nm
    0.72006f,           // 580 nm
    0.29400f,           // 620 nm
    0.21989f,           // 660 nm
    0.21100f,           // 700 nm
    0.23068f,           // 740 nm
};

Spectrum g_sGoldExtinction = {
    1.9288f,            // 380 nm
    1.9541f,            // 420 nm
    1.8851f,            // 460 nm
    1.8737f,            // 500 nm
    2.3389f,            // 540 nm
    2.8374f,            // 580 nm
    3.3039f,            // 620 nm
    3.7015f,            // 660 nm
    4.0624f,            // 700 nm
    4.4056f,            // 740 nm
};
Spectrum g_sGoldRefraction = {
    1.4622f,            // 380 nm
    1.4561f,            // 420 nm
    1.3489f,            // 460 nm
    0.97112f,           // 500 nm
    0.48899f,           // 540 nm
    0.29878f,           // 580 nm
    0.20475f,           // 620 nm
    0.13989f,           // 660 nm
    0.13100f,           // 700 nm
    0.13689f,           // 740 nm
};

Spectrum g_sIronExtinction = {
    2.4946f,            // 380 nm
    2.6733f,            // 420 nm
    2.7925f,            // 460 nm
    2.8848f,            // 500 nm
    2.9236f,            // 540 nm
    2.9864f,            // 580 nm
    3.0536f,            // 620 nm
    3.1020f,            // 660 nm
    3.1820f,            // 700 nm
    3.2523f,            // 740 nm
};
Spectrum g_sIronRefraction = {
    2.1123f,            // 380 nm
    2.4006f,            // 420 nm
    2.6260f,            // 460 nm
    2.7592f,            // 500 nm
    2.9211f,            // 540 nm
    2.9406f,            // 580 nm
    2.8829f,            // 620 nm
    2.9187f,            // 660 nm
    2.8653f,            // 700 nm
    2.8669f,            // 740 nm
};

Spectrum g_sAluminumExtinction = {
    4.5866f,            // 380 nm
    5.0843f,            // 420 nm
    5.5748f,            // 460 nm
    6.0481f,            // 500 nm
    6.5119f,            // 540 nm
    6.9650f,            // 580 nm
    7.4059f,            // 620 nm
    7.8042f,            // 660 nm
    8.1420f,            // 700 nm
    8.3881f,            // 740 nm
};
Spectrum g_sAluminumRefraction = {
    0.43744f,            // 380 nm
    0.54105f,            // 420 nm
    0.66843f,            // 460 nm
    0.81257f,            // 500 nm
    0.97274f,            // 540 nm
    1.1583f,            // 580 nm
    1.3664f,            // 620 nm
    1.6270f,            // 660 nm
    1.9214f,            // 700 nm
    2.2671f,            // 740 nm
};

Spectrum g_sOsmiumExtinction = {
    4.0900f,            // 380 nm
    4.5600f,            // 420 nm
    4.5400f,            // 460 nm
    4.0100f,            // 500 nm
    3.2260f,            // 540 nm
    2.4560f,            // 580 nm
    1.9840f,            // 620 nm
    1.8380f,            // 660 nm
    1.6700f,            // 700 nm
    1.6460f,            // 740 nm
};
Spectrum g_sOsmiumRefraction = {
    3.0200f,            // 380 nm
    3.6600f,            // 420 nm
    4.7380f,            // 460 nm
    5.4300f,            // 500 nm
    5.7960f,            // 540 nm
    5.5760f,            // 580 nm
    5.2320f,            // 620 nm
    4.6940f,            // 660 nm
    4.2300f,            // 700 nm
    3.8780f,            // 740 nm
};

Spectrum g_sSilverExtinction = {
    1.8412f,            // 380 nm
    2.3478f,            // 420 nm
    2.7511f,            // 460 nm
    3.1309f,            // 500 nm
    3.5047f,            // 540 nm
    3.8409f,            // 580 nm
    4.1768f,            // 620 nm
    4.4869f,            // 660 nm
    4.8025f,            // 700 nm
    5.1165f,            // 740 nm
};
Spectrum g_sSilverRefraction = {
    0.052206f,            // 380 nm
    0.046105f,            // 420 nm
    0.044439f,            // 460 nm
    0.050000f,            // 500 nm
    0.056895f,            // 540 nm
    0.050627f,            // 580 nm
    0.059251f,            // 620 nm
    0.049889f,            // 660 nm
    0.041000f,            // 700 nm
    0.033107f,            // 740 nm
};

Spectrum g_sTitaniumExtinction = {
    2.9277f,            // 380 nm
    2.9917f,            // 420 nm
    3.0670f,            // 460 nm
    3.2076f,            // 500 nm
    3.3882f,            // 540 nm
    3.5709f,            // 580 nm
    3.7286f,            // 620 nm
    3.8427f,            // 660 nm
    3.9493f,            // 700 nm
    3.9946f,            // 740 nm
};
Spectrum g_sTitaniumRefraction = {
    1.9831f,            // 380 nm
    2.1672f,            // 420 nm
    2.2925f,            // 460 nm
    2.3728f,            // 500 nm
    2.5079f,            // 540 nm
    2.5964f,            // 580 nm
    2.6764f,            // 620 nm
    2.7622f,            // 660 nm
    2.8511f,            // 700 nm
    2.9569f,            // 740 nm
};

//
//  Generated by BuildSpectrumRGB()
//

//  (1.001222, 0.000963, 0.000905),
Spectrum g_sRed ={
    0.04127986f,
    0.04389563f,
    0.00743457f,
    0.00020746f,
    0.00000000f,
    0.15975598f,
    0.63748634f,
    0.73956841f,
    0.75025010f,
    0.75438422f,
};
//  (0.000080, 1.000063, 0.000060),
Spectrum g_sGreen ={
    0.03716764f,
    0.00000000f,
    0.03969388f,
    0.58193165f,
    0.84618288f,
    0.45672303f,
    0.04948499f,
    0.00002113f,
    0.00001912f,
    0.00001829f,
};
//  (0.000239, 0.000188, 1.000177),
Spectrum g_sBlue ={
    0.86278629f,
    0.88470882f,
    0.73327857f,
    0.27020201f,
    0.00000000f,
    0.00012134f,
    0.01903665f,
    0.03156731f,
    0.03464860f,
    0.03623678f,
};
//  (1.000020, 1.000016, 0.000015),
Spectrum g_sYellow ={
    0.02498501f,
    0.00000000f,
    0.07708471f,
    0.50683933f,
    0.80404902f,
    0.74234891f,
    0.59418279f,
    0.56076300f,
    0.55727810f,
    0.55600959f,
};
//  (-0.000000, 1.000000, 1.000000),
Spectrum g_sCyan ={
    0.77649236f,
    0.77060646f,
    0.81262338f,
    0.91485178f,
    0.82855231f,
    0.43170390f,
    0.10552412f,
    0.04062022f,
    0.03450841f,
    0.03293108f,
};
//  (1.000269, 0.000212, 1.000199),
Spectrum g_sMagenta ={
    0.91435200f,
    0.94153363f,
    0.74621248f,
    0.19281457f,
    0.00000000f,
    0.21770276f,
    0.60449207f,
    0.68478608f,
    0.69259113f,
    0.69532830f,
};
//  (1.000000, 1.000000, 1.000000),
Spectrum g_sWhite ={
    0.82757425f,
    0.82687289f,
    0.82731515f,
    0.82851970f,
    0.79596937f,
    0.71325397f,
    0.64351559f,
    0.63135964f,
    0.63028973f,
    0.63006920f,
};
//  (0.999985, 0.499995, 0.000005),
Spectrum g_sOrange ={
    0.01368362f,
    0.00631349f,
    0.05482247f,
    0.21392965f,
    0.38362676f,
    0.51171911f,
    0.56722856f,
    0.57775819f,
    0.57859421f,
    0.57866693f,
};

//  (0.0 0.0 0.0)
Spectrum g_sBlack = {
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
    0.00000000f,
};

Spectrum g_sEqualWhite = {
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
    1.00000000f,
};

Spectrum g_sD6500 = {
    0.74602497f,
    0.78942293f,
    0.79451704f,
    0.77250618f,
    0.73323464f,
    0.68429673f,
    0.63109404f,
    0.57723445f,
    0.52498573f,
    0.47566929f,
};

//
//  Some metal linear RGB values
//
DisplayRGB g_rgbIron(0.562, 0.565, 0.578), g_rgbCopper(0.955, 0.638, 0.538), g_rgbGold(1.022, 0.782, 0.344);
DisplayRGB g_rgbZinc(0.664, 0.824, 0.850), g_rgbZilver(0.972, 0.960, 0.915), g_rgbAluminum(0.913, 0.922, 0.924);
DisplayRGB g_rgbSilicon(0.345, 0.369, 0.426);

Spectrum 
RGBtoSpectrum(DisplayRGB rgb, int n6500)
{
    Spectrum s;

    if (rgb.red < rgb.grn && rgb.red < rgb.blu) {
        s = g_sWhite*rgb.red + g_sGreen*(rgb.grn - rgb.red) + g_sBlue*(rgb.blu - rgb.red);
    } else if (rgb.grn < rgb.red && rgb.grn < rgb.blu) {
        s = g_sWhite*rgb.grn + g_sRed*(rgb.red - rgb.grn) + g_sBlue*(rgb.blu - rgb.grn);
    } else {
        s = g_sWhite*rgb.blu + g_sRed*(rgb.red - rgb.blu) + g_sGreen*(rgb.grn - rgb.blu);
    }
    if (n6500)
        s = s / g_sD6500;
    return s;
    // return g_sRed * rgb.red + g_sGreen * rgb.grn + g_sBlue * rgb.blu;
}

Spectrum
RGBtoSpectrum(double f)
{
    return g_sWhite * f;
}

DisplayRGB
Spectrum::vRGB() const                  // rgb with Venera-13 spectral response
{
    DisplayRGB rgb = 0.0;
    int i;

    for (i = 0; i < NSPEC; i++) {
        rgb.red += rgf[i] * g_sRedChannel.rgf[i];
        rgb.grn += rgf[i] * g_sGrnChannel.rgf[i];
        rgb.blu += rgf[i] * g_sBluChannel.rgf[i];
    }
    return rgb;
}

static double
ExpMinusOne(double x)
{
    if (x < -0.0001 || x > 0.0001)
        return exp(x) - 1.0;
    else
        return x*(1.0 + 0.5*x*(1.0 + x/3.0*(1.0 + 0.25*x)));
}

Spectrum
BlackBody(double fKelvin)
{
    int i;
    double fLambda, fPlanck, c1, c2;
    Spectrum sd;

    if (fKelvin < 0.0) {
        return g_sBlack;
    }
    c1 = 2.0*D_PI * C_PLANCK * C_SPEEDOFLIGHT * C_SPEEDOFLIGHT;
    c2 = C_PLANCK * C_SPEEDOFLIGHT / C_BOLTZMANN;
    for (i = 0; i < NSPEC; i++) {
        fLambda = 1.0e-9 * (380 + NDELTASPEC*double(i));
        fPlanck = c1 / (fLambda*fLambda*fLambda*fLambda*fLambda*ExpMinusOne(c2/fLambda/fKelvin));
        sd.rgf[i] = float(fPlanck/30932027310080.0) / 12.0f;
    }
    return sd * 1.98;    // normalized to give RGB white at 6500 K
}
//
//  Build spectrum-to-RGB table
//
struct CIE_XYZ {
    double X, Y, Z;

        CIE_XYZ() {}
        CIE_XYZ(double a, double b, double c) : X(a), Y(b), Z(c) {}
};

extern CIE_XYZ XYZ_CIE[471];
DisplayRGB     RGB_CIE[471];

Matrix3 XYZtoRGB( 3.24081206321716,   -1.53730821609497, -0.498586475849151,
                 -0.969243109226226,   1.87596642971038,  0.0415550582110881,
                  0.0556384064257144, -0.204007476568222, 1.05712962150573);

Matrix3 XYZtoLMS( 0.15514, 0.54312, -0.03286,
                 -0.15514, 0.45684,  0.03286,
                  0.0,     0.0,      0.01608);

inline DisplayRGB
operator *(const Matrix3 &mat, const CIE_XYZ &xyz)
{
    DisplayRGB rgb;

    rgb.red = float(xyz.X*mat.m[0][0] + xyz.Y*mat.m[0][1] + xyz.Z*mat.m[0][2]);
    rgb.grn = float(xyz.X*mat.m[1][0] + xyz.Y*mat.m[1][1] + xyz.Z*mat.m[1][2]);
    rgb.blu = float(xyz.X*mat.m[2][0] + xyz.Y*mat.m[2][1] + xyz.Z*mat.m[2][2]);
    return rgb;
}

static double gs_fI0Alpha = 1.0/11.3019219521363;
static double gs_fAlphaSquared = 4.0*4.0;

static double
Kaiser4Filter(double x)
{
    double x1, x2, xTerm, fN, fSinc, fKaiser;

    x1 = x * 1.0/KAISER4_HALFWIDTH;
    x2 = x1*x1;
    if (x2 > 1.0)
        return 0.0;
    x2 = 0.25 * (gs_fAlphaSquared) * (1.0 - x2);
    fKaiser = 1.0 + x2;
    fN = 2.0;
    xTerm = x2;
    while (xTerm > 1.0e-4) {
        xTerm *= x2/(fN*fN);
        fN += 1.0;
        fKaiser += xTerm;
        xTerm *= x2/(fN*fN);
        fN += 1.0;
        fKaiser += xTerm;
    }
    x1 = D_PI*x;
    x2 = x1*x1;
    if (x2 < 0.00001)
        fSinc = 1.0 + x2*(-1.0/6.0 + x2*(1.0/120.0 + x2*(-1.0/5040.0 + x2*1.0/362880.0)));
    else
        fSinc = sin(x1)/x1;
    return fSinc * fKaiser * (gs_fI0Alpha);
}

static DisplayRGB rgc[NSPEC];

void
BuildRGBTables()
{
    int i, j;
    double x, f, fSum;
    CIE_XYZ xyz;
    DisplayRGB rgbConv;

    for (i = 360; i <= 830; i++) {
        xyz = XYZ_CIE[i - 360];
        RGB_CIE[i - 360] = XYZtoRGB * xyz;
    }
    for (j = 380; j <= 740; j += NDELTASPEC) {
        fSum = 0.0;
        rgbConv = ML_Black;
        for (i = -int(KAISER4_HALFWIDTH*NDELTASPEC); i <= int(KAISER4_HALFWIDTH*NDELTASPEC); i++) {
            if ((j - i) < 360 || (j - i) > 830)
                continue;
            x = double(i)/double(NDELTASPEC);
            f = Kaiser4Filter(x);
            fSum  += f;
            rgbConv = rgbConv + RGB_CIE[j - i - 360] * f;
        }
        rgc[(j - 380)/NDELTASPEC] = rgbConv / fSum;
    }
    printf("DisplayRGB SpectrumToRGB[NSPEC] = {\n");
    for (i = 0; i < NSPEC; i++) {
        printf("    DisplayRGB");
        rgc[i].Print();
    }
    printf("};\n");
    for (i = 0; i < NSPEC; i++) {
        RGB_CIE[380 - 360 + i*NDELTASPEC].Print();
    }
}
//
//  Gaussian Integration, degree 20
//  About as good as N = 100,000 Simpson, on a very smooth function.
//
static double gs_x20[10] = {
        0.0765265211334973380000, 0.2277858511416451000000,
        0.3737060887154195500000, 0.5108670019508271300000,
        0.6360536807265150200000, 0.7463319064601508000000,
        0.8391169718222187800000, 0.9122344282513259500000,
        0.9639719272779138100000, 0.9931285991850950000000,
};
static double gs_w20[10] = {
        0.1527533871307258700000, 0.1491729864726036900000,
        0.1420961093183819000000, 0.1316886384491766100000,
        0.1181945319615183400000, 0.1019301198172403400000,
        0.0832767415767047130000, 0.0626720483341090260000,
        0.0406014298003869110000, 0.0176140071391525790000,
};

static double gs_x4[2] = {
        sqrt((15.0 - 2.0*sqrt(30.0))/35.0),
        sqrt((15.0 + 2.0*sqrt(30.0))/35.0),
};
static double gs_w4[2] = {
        (18.0 - sqrt(30.0))/36.0,
        (18.0 + sqrt(30.0))/36.0,
};

double
GaussIntegrate20(double (*f)(double), double a, double b)
{
    double h, xm, y;
    int i;

    xm = 0.5*(a + b);
    h = 0.5*(b - a);
    y = 0.0;
    for (i = 0; i < 10; i++)
        y += gs_w20[i]*(f(xm - h*gs_x20[i]) + f(xm + h*gs_x20[i]));
    return y*h;
}

double
GaussIntegrate4(double (*f)(double), double a, double b)
{
    double h, xm, y;
    int i;

    xm = 0.5*(a + b);
    h = 0.5*(b - a);
    y = 0.0;
    for (i = 0; i < 10; i++)
        y += gs_w4[i]*(f(xm - h*gs_x4[i]) + f(xm + h*gs_x4[i]));
    return y*h;
}

double
SimpsonIntegrate(double (*f)(double), double x1, double x2, int N)
{
    double x , sum, h;
    int i;

    if (N < 5)
        N = 5;
    h = (x2 - x1)/double(N);
    sum = f(x1)*3.0/8.0
        + f(x1 + h)*7.0/6.0
        + f(x1 + h + h)*23.0/24.0
        + f(x2 - h - h)*23.0/24.0
        + f(x2 - h)*7.0/6.0
        + f(x2)*3.0/8.0;
    for (i = 3; i <= N - 3; i++) {
        x = x1 + double(i)*h;
        sum += f(x);
    }
    return sum*h;
}


//
//  CIE 1931 Tristimulus Values, 360 to 830 nm (Not Judd or Judd-Vos, the original)
//
CIE_XYZ XYZ_CIE[471] = {
    CIE_XYZ(0.000129900000,  0.000003917000,  0.000606100000),   // 360 nm
    CIE_XYZ(0.000145847000,  0.000004393581,  0.000680879200),
    CIE_XYZ(0.000163802100,  0.000004929604,  0.000765145600),
    CIE_XYZ(0.000184003700,  0.000005532136,  0.000860012400),
    CIE_XYZ(0.000206690200,  0.000006208245,  0.000966592800),
    CIE_XYZ(0.000232100000,  0.000006965000,  0.001086000000),
    CIE_XYZ(0.000260728000,  0.000007813219,  0.001220586000),
    CIE_XYZ(0.000293075000,  0.000008767336,  0.001372729000),
    CIE_XYZ(0.000329388000,  0.000009839844,  0.001543579000),
    CIE_XYZ(0.000369914000,  0.000011043230,  0.001734286000),
    CIE_XYZ(0.000414900000,  0.000012390000,  0.001946000000),   // 370 nm
    CIE_XYZ(0.000464158700,  0.000013886410,  0.002177777000),
    CIE_XYZ(0.000518986000,  0.000015557280,  0.002435809000),
    CIE_XYZ(0.000581854000,  0.000017442960,  0.002731953000),
    CIE_XYZ(0.000655234700,  0.000019583750,  0.003078064000),
    CIE_XYZ(0.000741600000,  0.000022020000,  0.003486000000),
    CIE_XYZ(0.000845029600,  0.000024839650,  0.003975227000),
    CIE_XYZ(0.000964526800,  0.000028041260,  0.004540880000),
    CIE_XYZ(0.001094949000,  0.000031531040,  0.005158320000),
    CIE_XYZ(0.001231154000,  0.000035215210,  0.005802907000),
    CIE_XYZ(0.001368000000,  0.000039000000,  0.006450001000),   // 380 nm
    CIE_XYZ(0.001502050000,  0.000042826400,  0.007083216000),
    CIE_XYZ(0.001642328000,  0.000046914600,  0.007745488000),
    CIE_XYZ(0.001802382000,  0.000051589600,  0.008501152000),
    CIE_XYZ(0.001995757000,  0.000057176400,  0.009414544000),
    CIE_XYZ(0.002236000000,  0.000064000000,  0.010549990000),
    CIE_XYZ(0.002535385000,  0.000072344210,  0.011965800000),
    CIE_XYZ(0.002892603000,  0.000082212240,  0.013655870000),
    CIE_XYZ(0.003300829000,  0.000093508160,  0.015588050000),
    CIE_XYZ(0.003753236000,  0.000106136100,  0.017730150000),
    CIE_XYZ(0.004243000000,  0.000120000000,  0.020050010000),   // 390 nm
    CIE_XYZ(0.004762389000,  0.000134984000,  0.022511360000),
    CIE_XYZ(0.005330048000,  0.000151492000,  0.025202880000),
    CIE_XYZ(0.005978712000,  0.000170208000,  0.028279720000),
    CIE_XYZ(0.006741117000,  0.000191816000,  0.031897040000),
    CIE_XYZ(0.007650000000,  0.000217000000,  0.036210000000),
    CIE_XYZ(0.008751373000,  0.000246906700,  0.041437710000),
    CIE_XYZ(0.010028880000,  0.000281240000,  0.047503720000),
    CIE_XYZ(0.011421700000,  0.000318520000,  0.054119880000),
    CIE_XYZ(0.012869010000,  0.000357266700,  0.060998030000),
    CIE_XYZ(0.014310000000,  0.000396000000,  0.067850010000),   // 400 nm
    CIE_XYZ(0.015704430000,  0.000433714700,  0.074486320000),
    CIE_XYZ(0.017147440000,  0.000473024000,  0.081361560000),
    CIE_XYZ(0.018781220000,  0.000517876000,  0.089153640000),
    CIE_XYZ(0.020748010000,  0.000572218700,  0.098540480000),
    CIE_XYZ(0.023190000000,  0.000640000000,  0.110200000000),
    CIE_XYZ(0.026207360000,  0.000724560000,  0.124613300000),
    CIE_XYZ(0.029782480000,  0.000825500000,  0.141701700000),
    CIE_XYZ(0.033880920000,  0.000941160000,  0.161303500000),
    CIE_XYZ(0.038468240000,  0.001069880000,  0.183256800000),
    CIE_XYZ(0.043510000000,  0.001210000000,  0.207400000000),   // 410 nm
    CIE_XYZ(0.048995600000,  0.001362091000,  0.233692100000),
    CIE_XYZ(0.055022600000,  0.001530752000,  0.262611400000),
    CIE_XYZ(0.061718800000,  0.001720368000,  0.294774600000),
    CIE_XYZ(0.069212000000,  0.001935323000,  0.330798500000),
    CIE_XYZ(0.077630000000,  0.002180000000,  0.371300000000),
    CIE_XYZ(0.086958110000,  0.002454800000,  0.416209100000),
    CIE_XYZ(0.097176720000,  0.002764000000,  0.465464200000),
    CIE_XYZ(0.108406300000,  0.003117800000,  0.519694800000),
    CIE_XYZ(0.120767200000,  0.003526400000,  0.579530300000),
    CIE_XYZ(0.134380000000,  0.004000000000,  0.645600000000),   // 420 nm
    CIE_XYZ(0.149358200000,  0.004546240000,  0.718483800000),
    CIE_XYZ(0.165395700000,  0.005159320000,  0.796713300000),
    CIE_XYZ(0.181983100000,  0.005829280000,  0.877845900000),
    CIE_XYZ(0.198611000000,  0.006546160000,  0.959439000000),
    CIE_XYZ(0.214770000000,  0.007300000000,  1.039050100000),
    CIE_XYZ(0.230186800000,  0.008086507000,  1.115367300000),
    CIE_XYZ(0.244879700000,  0.008908720000,  1.188497100000),
    CIE_XYZ(0.258777300000,  0.009767680000,  1.258123300000),
    CIE_XYZ(0.271807900000,  0.010664430000,  1.323929600000),
    CIE_XYZ(0.283900000000,  0.011600000000,  1.385600000000),   // 430 nm
    CIE_XYZ(0.294943800000,  0.012573170000,  1.442635200000),
    CIE_XYZ(0.304896500000,  0.013582720000,  1.494803500000),
    CIE_XYZ(0.313787300000,  0.014629680000,  1.542190300000),
    CIE_XYZ(0.321645400000,  0.015715090000,  1.584880700000),
    CIE_XYZ(0.328500000000,  0.016840000000,  1.622960000000),
    CIE_XYZ(0.334351300000,  0.018007360000,  1.656404800000),
    CIE_XYZ(0.339210100000,  0.019214480000,  1.685295900000),
    CIE_XYZ(0.343121300000,  0.020453920000,  1.709874500000),
    CIE_XYZ(0.346129600000,  0.021718240000,  1.730382100000),
    CIE_XYZ(0.348280000000,  0.023000000000,  1.747060000000),   // 440 nm
    CIE_XYZ(0.349599900000,  0.024294610000,  1.760044600000),
    CIE_XYZ(0.350147400000,  0.025610240000,  1.769623300000),
    CIE_XYZ(0.350013000000,  0.026958570000,  1.776263700000),
    CIE_XYZ(0.349287000000,  0.028351250000,  1.780433400000),
    CIE_XYZ(0.348060000000,  0.029800000000,  1.782600000000),
    CIE_XYZ(0.346373300000,  0.031310830000,  1.782968200000),
    CIE_XYZ(0.344262400000,  0.032883680000,  1.781699800000),
    CIE_XYZ(0.341808800000,  0.034521120000,  1.779198200000),
    CIE_XYZ(0.339094100000,  0.036225710000,  1.775867100000),
    CIE_XYZ(0.336200000000,  0.038000000000,  1.772110000000),   // 450 nm
    CIE_XYZ(0.333197700000,  0.039846670000,  1.768258900000),
    CIE_XYZ(0.330041100000,  0.041768000000,  1.764039000000),
    CIE_XYZ(0.326635700000,  0.043766000000,  1.758943800000),
    CIE_XYZ(0.322886800000,  0.045842670000,  1.752466300000),
    CIE_XYZ(0.318700000000,  0.048000000000,  1.744100000000),
    CIE_XYZ(0.314025100000,  0.050243680000,  1.733559500000),
    CIE_XYZ(0.308884000000,  0.052573040000,  1.720858100000),
    CIE_XYZ(0.303290400000,  0.054980560000,  1.705936900000),
    CIE_XYZ(0.297257900000,  0.057458720000,  1.688737200000),
    CIE_XYZ(0.290800000000,  0.060000000000,  1.669200000000),   // 460 nm
    CIE_XYZ(0.283970100000,  0.062601970000,  1.647528700000),
    CIE_XYZ(0.276721400000,  0.065277520000,  1.623412700000),
    CIE_XYZ(0.268917800000,  0.068042080000,  1.596022300000),
    CIE_XYZ(0.260422700000,  0.070911090000,  1.564528000000),
    CIE_XYZ(0.251100000000,  0.073900000000,  1.528100000000),
    CIE_XYZ(0.240847500000,  0.077016000000,  1.486111400000),
    CIE_XYZ(0.229851200000,  0.080266400000,  1.439521500000),
    CIE_XYZ(0.218407200000,  0.083666800000,  1.389879900000),
    CIE_XYZ(0.206811500000,  0.087232800000,  1.338736200000),
    CIE_XYZ(0.195360000000,  0.090980000000,  1.287640000000),   // 470 nm
    CIE_XYZ(0.184213600000,  0.094917550000,  1.237422300000),
    CIE_XYZ(0.173327300000,  0.099045840000,  1.187824300000),
    CIE_XYZ(0.162688100000,  0.103367400000,  1.138761100000),
    CIE_XYZ(0.152283300000,  0.107884600000,  1.090148000000),
    CIE_XYZ(0.142100000000,  0.112600000000,  1.041900000000),
    CIE_XYZ(0.132178600000,  0.117532000000,  0.994197600000),
    CIE_XYZ(0.122569600000,  0.122674400000,  0.947347300000),
    CIE_XYZ(0.113275200000,  0.127992800000,  0.901453100000),
    CIE_XYZ(0.104297900000,  0.133452800000,  0.856619300000),
    CIE_XYZ(0.095640000000,  0.139020000000,  0.812950100000),   // 480 nm
    CIE_XYZ(0.087299550000,  0.144676400000,  0.770517300000),
    CIE_XYZ(0.079308040000,  0.150469300000,  0.729444800000),
    CIE_XYZ(0.071717760000,  0.156461900000,  0.689913600000),
    CIE_XYZ(0.064580990000,  0.162717700000,  0.652104900000),
    CIE_XYZ(0.057950010000,  0.169300000000,  0.616200000000),
    CIE_XYZ(0.051862110000,  0.176243100000,  0.582328600000),
    CIE_XYZ(0.046281520000,  0.183558100000,  0.550416200000),
    CIE_XYZ(0.041150880000,  0.191273500000,  0.520337600000),
    CIE_XYZ(0.036412830000,  0.199418000000,  0.491967300000),
    CIE_XYZ(0.032010000000,  0.208020000000,  0.465180000000),   // 490 nm
    CIE_XYZ(0.027917200000,  0.217119900000,  0.439924600000),
    CIE_XYZ(0.024144400000,  0.226734500000,  0.416183600000),
    CIE_XYZ(0.020687000000,  0.236857100000,  0.393882200000),
    CIE_XYZ(0.017540400000,  0.247481200000,  0.372945900000),
    CIE_XYZ(0.014700000000,  0.258600000000,  0.353300000000),
    CIE_XYZ(0.012161790000,  0.270184900000,  0.334857800000),
    CIE_XYZ(0.009919960000,  0.282293900000,  0.317552100000),
    CIE_XYZ(0.007967240000,  0.295050500000,  0.301337500000),
    CIE_XYZ(0.006296346000,  0.308578000000,  0.286168600000),
    CIE_XYZ(0.004900000000,  0.323000000000,  0.272000000000),   // 500 nm
    CIE_XYZ(0.003777173000,  0.338402100000,  0.258817100000),
    CIE_XYZ(0.002945320000,  0.354685800000,  0.246483800000),
    CIE_XYZ(0.002424880000,  0.371698600000,  0.234771800000),
    CIE_XYZ(0.002236293000,  0.389287500000,  0.223453300000),
    CIE_XYZ(0.002400000000,  0.407300000000,  0.212300000000),
    CIE_XYZ(0.002925520000,  0.425629900000,  0.201169200000),
    CIE_XYZ(0.003836560000,  0.444309600000,  0.190119600000),
    CIE_XYZ(0.005174840000,  0.463394400000,  0.179225400000),
    CIE_XYZ(0.006982080000,  0.482939500000,  0.168560800000),
    CIE_XYZ(0.009300000000,  0.503000000000,  0.158200000000),   // 510 nm
    CIE_XYZ(0.012149490000,  0.523569300000,  0.148138300000),
    CIE_XYZ(0.015535880000,  0.544512000000,  0.138375800000),
    CIE_XYZ(0.019477520000,  0.565690000000,  0.128994200000),
    CIE_XYZ(0.023992770000,  0.586965300000,  0.120075100000),
    CIE_XYZ(0.029100000000,  0.608200000000,  0.111700000000),
    CIE_XYZ(0.034814850000,  0.629345600000,  0.103904800000),
    CIE_XYZ(0.041120160000,  0.650306800000,  0.096667480000),
    CIE_XYZ(0.047985040000,  0.670875200000,  0.089982720000),
    CIE_XYZ(0.055378610000,  0.690842400000,  0.083845310000),
    CIE_XYZ(0.063270000000,  0.710000000000,  0.078249990000),   // 520 nm
    CIE_XYZ(0.071635010000,  0.728185200000,  0.073208990000),
    CIE_XYZ(0.080462240000,  0.745463600000,  0.068678160000),
    CIE_XYZ(0.089739960000,  0.761969400000,  0.064567840000),
    CIE_XYZ(0.099456450000,  0.777836800000,  0.060788350000),
    CIE_XYZ(0.109600000000,  0.793200000000,  0.057250010000),
    CIE_XYZ(0.120167400000,  0.808110400000,  0.053904350000),
    CIE_XYZ(0.131114500000,  0.822496200000,  0.050746640000),
    CIE_XYZ(0.142367900000,  0.836306800000,  0.047752760000),
    CIE_XYZ(0.153854200000,  0.849491600000,  0.044898590000),
    CIE_XYZ(0.165500000000,  0.862000000000,  0.042160000000),   // 530 nm
    CIE_XYZ(0.177257100000,  0.873810800000,  0.039507280000),
    CIE_XYZ(0.189140000000,  0.884962400000,  0.036935640000),
    CIE_XYZ(0.201169400000,  0.895493600000,  0.034458360000),
    CIE_XYZ(0.213365800000,  0.905443200000,  0.032088720000),
    CIE_XYZ(0.225749900000,  0.914850100000,  0.029840000000),
    CIE_XYZ(0.238320900000,  0.923734800000,  0.027711810000),
    CIE_XYZ(0.251066800000,  0.932092400000,  0.025694440000),
    CIE_XYZ(0.263992200000,  0.939922600000,  0.023787160000),
    CIE_XYZ(0.277101700000,  0.947225200000,  0.021989250000),
    CIE_XYZ(0.290400000000,  0.954000000000,  0.020300000000),   // 540 nm
    CIE_XYZ(0.303891200000,  0.960256100000,  0.018718050000),
    CIE_XYZ(0.317572600000,  0.966007400000,  0.017240360000),
    CIE_XYZ(0.331438400000,  0.971260600000,  0.015863640000),
    CIE_XYZ(0.345482800000,  0.976022500000,  0.014584610000),
    CIE_XYZ(0.359700000000,  0.980300000000,  0.013400000000),
    CIE_XYZ(0.374083900000,  0.984092400000,  0.012307230000),
    CIE_XYZ(0.388639600000,  0.987418200000,  0.011301880000),
    CIE_XYZ(0.403378400000,  0.990312800000,  0.010377920000),
    CIE_XYZ(0.418311500000,  0.992811600000,  0.009529306000),
    CIE_XYZ(0.433449900000,  0.994950100000,  0.008749999000),   // 550 nm
    CIE_XYZ(0.448795300000,  0.996710800000,  0.008035200000),
    CIE_XYZ(0.464336000000,  0.998098300000,  0.007381600000),
    CIE_XYZ(0.480064000000,  0.999112000000,  0.006785400000),
    CIE_XYZ(0.495971300000,  0.999748200000,  0.006242800000),
    CIE_XYZ(0.512050100000,  1.000000000000,  0.005749999000),
    CIE_XYZ(0.528295900000,  0.999856700000,  0.005303600000),
    CIE_XYZ(0.544691600000,  0.999304600000,  0.004899800000),
    CIE_XYZ(0.561209400000,  0.998325500000,  0.004534200000),
    CIE_XYZ(0.577821500000,  0.996898700000,  0.004202400000),
    CIE_XYZ(0.594500000000,  0.995000000000,  0.003900000000),   // 560 nm
    CIE_XYZ(0.611220900000,  0.992600500000,  0.003623200000),
    CIE_XYZ(0.627975800000,  0.989742600000,  0.003370600000),
    CIE_XYZ(0.644760200000,  0.986444400000,  0.003141400000),
    CIE_XYZ(0.661569700000,  0.982724100000,  0.002934800000),
    CIE_XYZ(0.678400000000,  0.978600000000,  0.002749999000),
    CIE_XYZ(0.695239200000,  0.974083700000,  0.002585200000),
    CIE_XYZ(0.712058600000,  0.969171200000,  0.002438600000),
    CIE_XYZ(0.728828400000,  0.963856800000,  0.002309400000),
    CIE_XYZ(0.745518800000,  0.958134900000,  0.002196800000),
    CIE_XYZ(0.762100000000,  0.952000000000,  0.002100000000),   // 570 nm
    CIE_XYZ(0.778543200000,  0.945450400000,  0.002017733000),
    CIE_XYZ(0.794825600000,  0.938499200000,  0.001948200000),
    CIE_XYZ(0.810926400000,  0.931162800000,  0.001889800000),
    CIE_XYZ(0.826824800000,  0.923457600000,  0.001840933000),
    CIE_XYZ(0.842500000000,  0.915400000000,  0.001800000000),
    CIE_XYZ(0.857932500000,  0.907006400000,  0.001766267000),
    CIE_XYZ(0.873081600000,  0.898277200000,  0.001737800000),
    CIE_XYZ(0.887894400000,  0.889204800000,  0.001711200000),
    CIE_XYZ(0.902318100000,  0.879781600000,  0.001683067000),
    CIE_XYZ(0.916300000000,  0.870000000000,  0.001650001000),   // 580 nm
    CIE_XYZ(0.929799500000,  0.859861300000,  0.001610133000),
    CIE_XYZ(0.942798400000,  0.849392000000,  0.001564400000),
    CIE_XYZ(0.955277600000,  0.838622000000,  0.001513600000),
    CIE_XYZ(0.967217900000,  0.827581300000,  0.001458533000),
    CIE_XYZ(0.978600000000,  0.816300000000,  0.001400000000),
    CIE_XYZ(0.989385600000,  0.804794700000,  0.001336667000),
    CIE_XYZ(0.999548800000,  0.793082000000,  0.001270000000),
    CIE_XYZ(1.009089200000,  0.781192000000,  0.001205000000),
    CIE_XYZ(1.018006400000,  0.769154700000,  0.001146667000),
    CIE_XYZ(1.026300000000,  0.757000000000,  0.001100000000),   // 590 nm
    CIE_XYZ(1.033982700000,  0.744754100000,  0.001068800000),
    CIE_XYZ(1.040986000000,  0.732422400000,  0.001049400000),
    CIE_XYZ(1.047188000000,  0.720003600000,  0.001035600000),
    CIE_XYZ(1.052466700000,  0.707496500000,  0.001021200000),
    CIE_XYZ(1.056700000000,  0.694900000000,  0.001000000000),
    CIE_XYZ(1.059794400000,  0.682219200000,  0.000968640000),
    CIE_XYZ(1.061799200000,  0.669471600000,  0.000929920000),
    CIE_XYZ(1.062806800000,  0.656674400000,  0.000886880000),
    CIE_XYZ(1.062909600000,  0.643844800000,  0.000842560000),
    CIE_XYZ(1.062200000000,  0.631000000000,  0.000800000000),   // 600 nm
    CIE_XYZ(1.060735200000,  0.618155500000,  0.000760960000),
    CIE_XYZ(1.058443600000,  0.605314400000,  0.000723680000),
    CIE_XYZ(1.055224400000,  0.592475600000,  0.000685920000),
    CIE_XYZ(1.050976800000,  0.579637900000,  0.000645440000),
    CIE_XYZ(1.045600000000,  0.566800000000,  0.000600000000),
    CIE_XYZ(1.039036900000,  0.553961100000,  0.000547866700),
    CIE_XYZ(1.031360800000,  0.541137200000,  0.000491600000),
    CIE_XYZ(1.022666200000,  0.528352800000,  0.000435400000),
    CIE_XYZ(1.013047700000,  0.515632300000,  0.000383466700),
    CIE_XYZ(1.002600000000,  0.503000000000,  0.000340000000),   // 610 nm
    CIE_XYZ(0.991367500000,  0.490468800000,  0.000307253300),
    CIE_XYZ(0.979331400000,  0.478030400000,  0.000283160000),
    CIE_XYZ(0.966491600000,  0.465677600000,  0.000265440000),
    CIE_XYZ(0.952847900000,  0.453403200000,  0.000251813300),
    CIE_XYZ(0.938400000000,  0.441200000000,  0.000240000000),
    CIE_XYZ(0.923194000000,  0.429080000000,  0.000229546700),
    CIE_XYZ(0.907244000000,  0.417036000000,  0.000220640000),
    CIE_XYZ(0.890502000000,  0.405032000000,  0.000211960000),
    CIE_XYZ(0.872920000000,  0.393032000000,  0.000202186700),
    CIE_XYZ(0.854449900000,  0.381000000000,  0.000190000000),   // 620 nm
    CIE_XYZ(0.835084000000,  0.368918400000,  0.000174213300),
    CIE_XYZ(0.814946000000,  0.356827200000,  0.000155640000),
    CIE_XYZ(0.794186000000,  0.344776800000,  0.000135960000),
    CIE_XYZ(0.772954000000,  0.332817600000,  0.000116853300),
    CIE_XYZ(0.751400000000,  0.321000000000,  0.000100000000),
    CIE_XYZ(0.729583600000,  0.309338100000,  0.000086133330),
    CIE_XYZ(0.707588800000,  0.297850400000,  0.000074600000),
    CIE_XYZ(0.685602200000,  0.286593600000,  0.000065000000),
    CIE_XYZ(0.663810400000,  0.275624500000,  0.000056933330),
    CIE_XYZ(0.642400000000,  0.265000000000,  0.000049999990),   // 630 nm
    CIE_XYZ(0.621514900000,  0.254763200000,  0.000044160000),
    CIE_XYZ(0.601113800000,  0.244889600000,  0.000039480000),
    CIE_XYZ(0.581105200000,  0.235334400000,  0.000035720000),
    CIE_XYZ(0.561397700000,  0.226052800000,  0.000032640000),
    CIE_XYZ(0.541900000000,  0.217000000000,  0.000030000000),
    CIE_XYZ(0.522599500000,  0.208161600000,  0.000027653330),
    CIE_XYZ(0.503546400000,  0.199548800000,  0.000025560000),
    CIE_XYZ(0.484743600000,  0.191155200000,  0.000023640000),
    CIE_XYZ(0.466193900000,  0.182974400000,  0.000021813330),
    CIE_XYZ(0.447900000000,  0.175000000000,  0.000020000000),   // 640 nm
    CIE_XYZ(0.429861300000,  0.167223500000,  0.000018133330),
    CIE_XYZ(0.412098000000,  0.159646400000,  0.000016200000),
    CIE_XYZ(0.394644000000,  0.152277600000,  0.000014200000),
    CIE_XYZ(0.377533300000,  0.145125900000,  0.000012133330),
    CIE_XYZ(0.360800000000,  0.138200000000,  0.000010000000),
    CIE_XYZ(0.344456300000,  0.131500300000,  0.000007733333),
    CIE_XYZ(0.328516800000,  0.125024800000,  0.000005400000),
    CIE_XYZ(0.313019200000,  0.118779200000,  0.000003200000),
    CIE_XYZ(0.298001100000,  0.112769100000,  0.000001333333),
    CIE_XYZ(0.283500000000,  0.107000000000,  0.000000000000),   // 650 nm
    CIE_XYZ(0.269544800000,  0.101476200000,  0.000000000000),
    CIE_XYZ(0.256118400000,  0.096188640000,  0.000000000000),
    CIE_XYZ(0.243189600000,  0.091122960000,  0.000000000000),
    CIE_XYZ(0.230727200000,  0.086264850000,  0.000000000000),
    CIE_XYZ(0.218700000000,  0.081600000000,  0.000000000000),
    CIE_XYZ(0.207097100000,  0.077120640000,  0.000000000000),
    CIE_XYZ(0.195923200000,  0.072825520000,  0.000000000000),
    CIE_XYZ(0.185170800000,  0.068710080000,  0.000000000000),
    CIE_XYZ(0.174832300000,  0.064769760000,  0.000000000000),
    CIE_XYZ(0.164900000000,  0.061000000000,  0.000000000000),   // 660 nm
    CIE_XYZ(0.155366700000,  0.057396210000,  0.000000000000),
    CIE_XYZ(0.146230000000,  0.053955040000,  0.000000000000),
    CIE_XYZ(0.137490000000,  0.050673760000,  0.000000000000),
    CIE_XYZ(0.129146700000,  0.047549650000,  0.000000000000),
    CIE_XYZ(0.121200000000,  0.044580000000,  0.000000000000),
    CIE_XYZ(0.113639700000,  0.041758720000,  0.000000000000),
    CIE_XYZ(0.106465000000,  0.039084960000,  0.000000000000),
    CIE_XYZ(0.099690440000,  0.036563840000,  0.000000000000),
    CIE_XYZ(0.093330610000,  0.034200480000,  0.000000000000),
    CIE_XYZ(0.087400000000,  0.032000000000,  0.000000000000),   // 670 nm
    CIE_XYZ(0.081900960000,  0.029962610000,  0.000000000000),
    CIE_XYZ(0.076804280000,  0.028076640000,  0.000000000000),
    CIE_XYZ(0.072077120000,  0.026329360000,  0.000000000000),
    CIE_XYZ(0.067686640000,  0.024708050000,  0.000000000000),
    CIE_XYZ(0.063600000000,  0.023200000000,  0.000000000000),
    CIE_XYZ(0.059806850000,  0.021800770000,  0.000000000000),
    CIE_XYZ(0.056282160000,  0.020501120000,  0.000000000000),
    CIE_XYZ(0.052971040000,  0.019281080000,  0.000000000000),
    CIE_XYZ(0.049818610000,  0.018120690000,  0.000000000000),
    CIE_XYZ(0.046770000000,  0.017000000000,  0.000000000000),   // 680 nm
    CIE_XYZ(0.043784050000,  0.015903790000,  0.000000000000),
    CIE_XYZ(0.040875360000,  0.014837180000,  0.000000000000),
    CIE_XYZ(0.038072640000,  0.013810680000,  0.000000000000),
    CIE_XYZ(0.035404610000,  0.012834780000,  0.000000000000),
    CIE_XYZ(0.032900000000,  0.011920000000,  0.000000000000),
    CIE_XYZ(0.030564190000,  0.011068310000,  0.000000000000),
    CIE_XYZ(0.028380560000,  0.010273390000,  0.000000000000),
    CIE_XYZ(0.026344840000,  0.009533311000,  0.000000000000),
    CIE_XYZ(0.024452750000,  0.008846157000,  0.000000000000),
    CIE_XYZ(0.022700000000,  0.008210000000,  0.000000000000),   // 690 nm
    CIE_XYZ(0.021084290000,  0.007623781000,  0.000000000000),
    CIE_XYZ(0.019599880000,  0.007085424000,  0.000000000000),
    CIE_XYZ(0.018237320000,  0.006591476000,  0.000000000000),
    CIE_XYZ(0.016987170000,  0.006138485000,  0.000000000000),
    CIE_XYZ(0.015840000000,  0.005723000000,  0.000000000000),
    CIE_XYZ(0.014790640000,  0.005343059000,  0.000000000000),
    CIE_XYZ(0.013831320000,  0.004995796000,  0.000000000000),
    CIE_XYZ(0.012948680000,  0.004676404000,  0.000000000000),
    CIE_XYZ(0.012129200000,  0.004380075000,  0.000000000000),
    CIE_XYZ(0.011359160000,  0.004102000000,  0.000000000000),   // 700 nm
    CIE_XYZ(0.010629350000,  0.003838453000,  0.000000000000),
    CIE_XYZ(0.009938846000,  0.003589099000,  0.000000000000),
    CIE_XYZ(0.009288422000,  0.003354219000,  0.000000000000),
    CIE_XYZ(0.008678854000,  0.003134093000,  0.000000000000),
    CIE_XYZ(0.008110916000,  0.002929000000,  0.000000000000),
    CIE_XYZ(0.007582388000,  0.002738139000,  0.000000000000),
    CIE_XYZ(0.007088746000,  0.002559876000,  0.000000000000),
    CIE_XYZ(0.006627313000,  0.002393244000,  0.000000000000),
    CIE_XYZ(0.006195408000,  0.002237275000,  0.000000000000),
    CIE_XYZ(0.005790346000,  0.002091000000,  0.000000000000),   // 710 nm
    CIE_XYZ(0.005409826000,  0.001953587000,  0.000000000000),
    CIE_XYZ(0.005052583000,  0.001824580000,  0.000000000000),
    CIE_XYZ(0.004717512000,  0.001703580000,  0.000000000000),
    CIE_XYZ(0.004403507000,  0.001590187000,  0.000000000000),
    CIE_XYZ(0.004109457000,  0.001484000000,  0.000000000000),
    CIE_XYZ(0.003833913000,  0.001384496000,  0.000000000000),
    CIE_XYZ(0.003575748000,  0.001291268000,  0.000000000000),
    CIE_XYZ(0.003334342000,  0.001204092000,  0.000000000000),
    CIE_XYZ(0.003109075000,  0.001122744000,  0.000000000000),
    CIE_XYZ(0.002899327000,  0.001047000000,  0.000000000000),   // 720 nm
    CIE_XYZ(0.002704348000,  0.000976589600,  0.000000000000),
    CIE_XYZ(0.002523020000,  0.000911108800,  0.000000000000),
    CIE_XYZ(0.002354168000,  0.000850133200,  0.000000000000),
    CIE_XYZ(0.002196616000,  0.000793238400,  0.000000000000),
    CIE_XYZ(0.002049190000,  0.000740000000,  0.000000000000),
    CIE_XYZ(0.001910960000,  0.000690082700,  0.000000000000),
    CIE_XYZ(0.001781438000,  0.000643310000,  0.000000000000),
    CIE_XYZ(0.001660110000,  0.000599496000,  0.000000000000),
    CIE_XYZ(0.001546459000,  0.000558454700,  0.000000000000),
    CIE_XYZ(0.001439971000,  0.000520000000,  0.000000000000),   // 730 nm
    CIE_XYZ(0.001340042000,  0.000483913600,  0.000000000000),
    CIE_XYZ(0.001246275000,  0.000450052800,  0.000000000000),
    CIE_XYZ(0.001158471000,  0.000418345200,  0.000000000000),
    CIE_XYZ(0.001076430000,  0.000388718400,  0.000000000000),
    CIE_XYZ(0.000999949300,  0.000361100000,  0.000000000000),
    CIE_XYZ(0.000928735800,  0.000335383500,  0.000000000000),
    CIE_XYZ(0.000862433200,  0.000311440400,  0.000000000000),
    CIE_XYZ(0.000800750300,  0.000289165600,  0.000000000000),
    CIE_XYZ(0.000743396000,  0.000268453900,  0.000000000000),
    CIE_XYZ(0.000690078600,  0.000249200000,  0.000000000000),   // 740 nm
    CIE_XYZ(0.000640515600,  0.000231301900,  0.000000000000),
    CIE_XYZ(0.000594502100,  0.000214685600,  0.000000000000),
    CIE_XYZ(0.000551864600,  0.000199288400,  0.000000000000),
    CIE_XYZ(0.000512429000,  0.000185047500,  0.000000000000),
    CIE_XYZ(0.000476021300,  0.000171900000,  0.000000000000),
    CIE_XYZ(0.000442453600,  0.000159778100,  0.000000000000),
    CIE_XYZ(0.000411511700,  0.000148604400,  0.000000000000),
    CIE_XYZ(0.000382981400,  0.000138301600,  0.000000000000),
    CIE_XYZ(0.000356649100,  0.000128792500,  0.000000000000),
    CIE_XYZ(0.000332301100,  0.000120000000,  0.000000000000),   // 750 nm
    CIE_XYZ(0.000309758600,  0.000111859500,  0.000000000000),
    CIE_XYZ(0.000288887100,  0.000104322400,  0.000000000000),
    CIE_XYZ(0.000269539400,  0.000097335600,  0.000000000000),
    CIE_XYZ(0.000251568200,  0.000090845870,  0.000000000000),
    CIE_XYZ(0.000234826100,  0.000084800000,  0.000000000000),
    CIE_XYZ(0.000219171000,  0.000079146670,  0.000000000000),
    CIE_XYZ(0.000204525800,  0.000073858000,  0.000000000000),
    CIE_XYZ(0.000190840500,  0.000068916000,  0.000000000000),
    CIE_XYZ(0.000178065400,  0.000064302670,  0.000000000000),
    CIE_XYZ(0.000166150500,  0.000060000000,  0.000000000000),   // 760 nm
    CIE_XYZ(0.000155023600,  0.000055981870,  0.000000000000),
    CIE_XYZ(0.000144621900,  0.000052225600,  0.000000000000),
    CIE_XYZ(0.000134909800,  0.000048718400,  0.000000000000),
    CIE_XYZ(0.000125852000,  0.000045447470,  0.000000000000),
    CIE_XYZ(0.000117413000,  0.000042400000,  0.000000000000),
    CIE_XYZ(0.000109551500,  0.000039561040,  0.000000000000),
    CIE_XYZ(0.000102224500,  0.000036915120,  0.000000000000),
    CIE_XYZ(0.000095394450,  0.000034448680,  0.000000000000),
    CIE_XYZ(0.000089023900,  0.000032148160,  0.000000000000),
    CIE_XYZ(0.000083075270,  0.000030000000,  0.000000000000),   // 770 nm
    CIE_XYZ(0.000077512690,  0.000027991250,  0.000000000000),
    CIE_XYZ(0.000072313040,  0.000026113560,  0.000000000000),
    CIE_XYZ(0.000067457780,  0.000024360240,  0.000000000000),
    CIE_XYZ(0.000062928440,  0.000022724610,  0.000000000000),
    CIE_XYZ(0.000058706520,  0.000021200000,  0.000000000000),
    CIE_XYZ(0.000054770280,  0.000019778550,  0.000000000000),
    CIE_XYZ(0.000051099180,  0.000018452850,  0.000000000000),
    CIE_XYZ(0.000047676540,  0.000017216870,  0.000000000000),
    CIE_XYZ(0.000044485670,  0.000016064590,  0.000000000000),
    CIE_XYZ(0.000041509940,  0.000014990000,  0.000000000000),   // 780 nm
    CIE_XYZ(0.000038733240,  0.000013987280,  0.000000000000),
    CIE_XYZ(0.000036142030,  0.000013051550,  0.000000000000),
    CIE_XYZ(0.000033723520,  0.000012178180,  0.000000000000),
    CIE_XYZ(0.000031464870,  0.000011362540,  0.000000000000),
    CIE_XYZ(0.000029353260,  0.000010600000,  0.000000000000),
    CIE_XYZ(0.000027375730,  0.000009885877,  0.000000000000),
    CIE_XYZ(0.000025524330,  0.000009217304,  0.000000000000),
    CIE_XYZ(0.000023793760,  0.000008592362,  0.000000000000),
    CIE_XYZ(0.000022178700,  0.000008009133,  0.000000000000),
    CIE_XYZ(0.000020673830,  0.000007465700,  0.000000000000),   // 790 nm
    CIE_XYZ(0.000019272260,  0.000006959567,  0.000000000000),
    CIE_XYZ(0.000017966400,  0.000006487995,  0.000000000000),
    CIE_XYZ(0.000016749910,  0.000006048699,  0.000000000000),
    CIE_XYZ(0.000015616480,  0.000005639396,  0.000000000000),
    CIE_XYZ(0.000014559770,  0.000005257800,  0.000000000000),
    CIE_XYZ(0.000013573870,  0.000004901771,  0.000000000000),
    CIE_XYZ(0.000012654360,  0.000004569720,  0.000000000000),
    CIE_XYZ(0.000011797230,  0.000004260194,  0.000000000000),
    CIE_XYZ(0.000010998440,  0.000003971739,  0.000000000000),
    CIE_XYZ(0.000010253980,  0.000003702900,  0.000000000000),   // 800 nm
    CIE_XYZ(0.000009559646,  0.000003452163,  0.000000000000),
    CIE_XYZ(0.000008912044,  0.000003218302,  0.000000000000),
    CIE_XYZ(0.000008308358,  0.000003000300,  0.000000000000),
    CIE_XYZ(0.000007745769,  0.000002797139,  0.000000000000),
    CIE_XYZ(0.000007221456,  0.000002607800,  0.000000000000),
    CIE_XYZ(0.000006732475,  0.000002431220,  0.000000000000),
    CIE_XYZ(0.000006276423,  0.000002266531,  0.000000000000),
    CIE_XYZ(0.000005851304,  0.000002113013,  0.000000000000),
    CIE_XYZ(0.000005455118,  0.000001969943,  0.000000000000),
    CIE_XYZ(0.000005085868,  0.000001836600,  0.000000000000),   // 810 nm
    CIE_XYZ(0.000004741466,  0.000001712230,  0.000000000000),
    CIE_XYZ(0.000004420236,  0.000001596228,  0.000000000000),
    CIE_XYZ(0.000004120783,  0.000001488090,  0.000000000000),
    CIE_XYZ(0.000003841716,  0.000001387314,  0.000000000000),
    CIE_XYZ(0.000003581652,  0.000001293400,  0.000000000000),
    CIE_XYZ(0.000003339127,  0.000001205820,  0.000000000000),
    CIE_XYZ(0.000003112949,  0.000001124143,  0.000000000000),
    CIE_XYZ(0.000002902121,  0.000001048009,  0.000000000000),
    CIE_XYZ(0.000002705645,  0.000000977058,  0.000000000000),
    CIE_XYZ(0.000002522525,  0.000000910930,  0.000000000000),   // 820 nm
    CIE_XYZ(0.000002351726,  0.000000849251,  0.000000000000),
    CIE_XYZ(0.000002192415,  0.000000791721,  0.000000000000),
    CIE_XYZ(0.000002043902,  0.000000738090,  0.000000000000),
    CIE_XYZ(0.000001905497,  0.000000688110,  0.000000000000),
    CIE_XYZ(0.000001776509,  0.000000641530,  0.000000000000),
    CIE_XYZ(0.000001656215,  0.000000598090,  0.000000000000),
    CIE_XYZ(0.000001544022,  0.000000557575,  0.000000000000),
    CIE_XYZ(0.000001439440,  0.000000519808,  0.000000000000),
    CIE_XYZ(0.000001341977,  0.000000484612,  0.000000000000),
    CIE_XYZ(0.000001251141,  0.000000451810,  0.000000000000),   // 830 nm
};
